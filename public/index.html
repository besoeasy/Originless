<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Originless</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    /* Import modern font */
    @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");

    body {
      font-family: "Inter", sans-serif;
    }

    /* Enhanced animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-30px);
          gatewayBase: "https://dweb.link/ipfs/",
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes pulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }
    }

    @keyframes shimmer {
      0% {
        background-position: -200px 0;
      }

      100% {
        background-position: calc(200px + 100%) 0;
      }
    }

    @keyframes bounce {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    @keyframes scalePulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }
    }

    @keyframes glow {

      0%,
      100% {
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
      }

      50% {
        box-shadow: 0 0 40px rgba(0, 0, 0, 0.4), 0 0 60px rgba(0, 0, 0, 0.2);
      }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fadeIn 0.6s ease-out;
    }

    .animate-slide-in-left {
      animation: slideInLeft 0.5s ease-out;
    }

    .animate-pulse-gentle {
      animation: pulse 2s ease-in-out infinite;
    }

    .shimmer {
      background: linear-gradient(90deg, #000 25%, #333 37%, #000 63%);
      background-size: 400% 100%;
      animation: shimmer 1.5s ease-in-out infinite;
    }

    /* Enhanced glassmorphism */
    .glassmorphism {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .glassmorphism-dark {
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Tab styles */
    .tab-button {
      transition: all 0.3s ease;
      border-bottom: 2px solid transparent;
    }

    .tab-button.active {
      border-bottom-color: #000;
      background: #f9f9f9;
    }

    .tab-button:hover:not(.active) {
      background: #f5f5f5;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    /* Enhanced hover effects */
    .hover-lift {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hover-lift:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    /* Status indicators */
    .status-indicator {
      position: relative;
    }

    .status-indicator::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 8px;
      height: 8px;
      background: #10b981;
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }

    /* Enhanced Drag and Drop Styles */
    .drop-zone {
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .drop-zone.drag-over {
      transform: scale(1.02);
      animation: scalePulse 1s ease-in-out infinite, glow 1.5s ease-in-out infinite;
    }

    .drop-zone.drag-over::before {
      content: "";
      position: absolute;
      inset: -4px;
      background: linear-gradient(45deg, #000, #333, #000, #333);
      background-size: 300% 300%;
      animation: shimmer 2s linear infinite;
      border-radius: 0.75rem;
      z-index: -1;
      opacity: 0.5;
    }

    .drop-zone.drag-over .drop-icon {
      animation: bounce 0.6s ease-in-out infinite;
      color: #000 !important;
      transform: scale(1.3);
    }

    .drop-zone.drag-over .drop-text {
      color: #000 !important;
      font-weight: 700;
    }

    .drop-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0.1) 100%);
      border-radius: 0.75rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 10;
    }

    .drop-zone.drag-over .drop-overlay {
      opacity: 1;
      animation: slideDown 0.3s ease-out;
    }

    .drop-indicator {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 3px dashed #000;
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    }

    .drop-indicator-icon {
      font-size: 3rem;
      color: #000;
      margin-bottom: 1rem;
      animation: bounce 0.6s ease-in-out infinite;
    }

    .drop-indicator-text {
      font-size: 1.25rem;
      font-weight: 700;
      color: #000;
      text-align: center;
    }

    /* Pulsing border effect */
    @keyframes borderPulse {

      0%,
      100% {
        border-color: #000;
        border-width: 2px;
      }

      50% {
        border-color: #333;
        border-width: 4px;
      }
    }

    .drop-zone.drag-over {
      animation: borderPulse 1s ease-in-out infinite;
    }
  </style>
</head>

<body class="min-h-screen bg-gray-100 flex items-center justify-center p-4">
  <div id="app" class="w-full max-w-6xl glassmorphism rounded-2xl shadow-xl overflow-hidden hover-lift" tabindex="0"
    @paste="handlePaste" @keydown.prevent>
    <!-- Header -->
    <header class="bg-black p-6 text-white text-center relative">
      <div class="flex items-center justify-center gap-3 mb-2">
        <i class="fas fa-cloud-upload-alt text-2xl"></i>
        <h1 class="text-3xl font-bold">Originless</h1>
      </div>
      <p class="text-gray-300 text-sm">Anonymous File Sharing</p>

      <!-- Donate Button -->
      <a href="https://sponsor.besoeasy.com/" target="_blank" rel="noopener noreferrer"
        class="absolute top-6 right-6 bg-white text-black px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all duration-300 flex items-center gap-2 shadow-lg hover:shadow-xl">
        <i class="fas fa-heart"></i>
        <span>Donate</span>
      </a>
    </header>

    <div class="flex flex-col md:flex-row">
      <!-- Sidebar: Status Panel -->
      <aside class="w-full md:w-80 bg-gray-50 p-6 border-r border-gray-200">
        <div class="flex items-center gap-2 mb-6">
          <div class="status-indicator">
            <i class="fas fa-server text-xl text-black"></i>
          </div>
          <h2 class="text-xl font-semibold text-black">Node Status</h2>
        </div>
        <div class="space-y-4 text-sm">
          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">Node ID</p>
            <p class="text-black truncate font-mono text-sm">{{ status.nodeId }}</p>
          </div>
          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">Connected Peers</p>
            <p class="text-black font-semibold">{{ status.peerscount }} Nodes</p>
          </div>
          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">Bandwidth (1h)</p>
            <p class="text-black font-mono text-sm">{{ status.bandwidth }}</p>
          </div>
          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">Repository Size</p>
            <p class="text-black font-semibold">{{ status.repoSize }}</p>
          </div>
          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">Objects</p>
            <p class="text-black font-semibold">{{ status.repoObjects }}</p>
          </div>
          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">Version</p>
            <p class="text-black font-mono text-sm">{{ status.version }}</p>
          </div>

          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">Storage Limit</p>
            <p class="text-black font-semibold">{{ status.storageLimit }}</p>
          </div>
          <div class="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
            <p class="text-gray-500 font-medium text-xs uppercase">File Size Limit</p>
            <p class="text-black font-semibold">{{ status.fileLimit }}</p>
          </div>

          <div class="bg-white rounded-lg p-3 mt-4 border border-gray-200">
            <p class="text-gray-500 text-xs font-medium">Last updated: {{ status.timestamp }}</p>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 p-8">
        <div class="space-y-6">
          <!-- Originless Zone -->
          <div class="relative">
            <label for="fileInput"
              class="drop-zone block w-full bg-gray-50 rounded-xl p-12 text-center cursor-pointer border-2 border-dashed border-gray-300 transition-all duration-300 hover:bg-gray-100 hover:border-black group"
              @dragover.prevent="isDragOver = true" @dragleave.prevent="isDragOver = false"
              @drop.prevent="handleDrop($event)" :class="{ 
                  'drag-over': isDragOver,
                  'bg-green-50 border-green-500': isPasted
                }">
              <div class="flex flex-col items-center gap-4">
                <i
                  class="drop-icon fas fa-cloud-upload-alt text-4xl text-gray-400 group-hover:text-black transition-colors duration-300"></i>
                <div>
                  <span
                    class="drop-text text-lg font-semibold text-gray-700 group-hover:text-black transition-colors duration-300">
                    {{ fileLabel }} </span>
                  <p class="text-sm text-gray-500 mt-2">Drag and drop your file here, click to browse, or paste anywhere
                    on the page</p>
                </div>
              </div>

              <!-- Drag Overlay Indicator -->
              <div class="drop-overlay">
                <div class="drop-indicator">
                  <i class="drop-indicator-icon fas fa-file-import"></i>
                  <div class="drop-indicator-text">Drop your file here!</div>
                </div>
              </div>
            </label>
            <input type="file" id="fileInput" class="hidden" @change="updateFileLabel" />
          </div>

          <!-- Upload Mode Toggle -->
          <div class="bg-gray-50 rounded-xl p-4 border border-gray-200">
            <div class="flex items-center justify-center gap-4">
              <button @click="uploadMode = 'file'" :class="[
                  'px-4 py-2 rounded-lg font-semibold transition-all duration-300',
                  uploadMode === 'file' 
                    ? 'bg-black text-white' 
                    : 'bg-white text-gray-600 hover:bg-gray-100'
                ]">
                <i class="fas fa-file-upload mr-2"></i>
                File Upload
              </button>
              <button @click="uploadMode = 'url'" :class="[
                  'px-4 py-2 rounded-lg font-semibold transition-all duration-300',
                  uploadMode === 'url' 
                    ? 'bg-black text-white' 
                    : 'bg-white text-gray-600 hover:bg-gray-100'
                ]">
                <i class="fas fa-link mr-2"></i>
                URL Upload
              </button>
            </div>
          </div>

          <!-- URL Upload Section -->
          <div v-if="uploadMode === 'url'" class="bg-gray-50 rounded-xl p-6 border border-gray-200 animate-fade-in">
            <div class="space-y-3">
              <label class="block">
                <span class="text-sm font-semibold text-gray-700 mb-2 block">
                  <i class="fas fa-globe mr-2"></i>Enter URL to upload
                </span>
                <input type="url" v-model="remoteUrl" placeholder="https://example.com/file.pdf"
                  class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-black transition-all duration-300"
                  @keyup.enter="uploadFile" />
              </label>
              <p class="text-xs text-gray-500">
                <i class="fas fa-info-circle mr-1"></i>
                Download content from any URL and upload to IPFS (max {{ status.remoteFileLimit }})
              </p>
            </div>
          </div>


          <button @click="uploadFile" :disabled="uploading || (!file && !remoteUrl)"
            class="w-full bg-black text-white py-3 rounded-xl font-semibold transition-all duration-300 hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed">
            <div class="flex items-center justify-center gap-2">
              <i class="fas fa-upload" :class="{ 'animate-pulse': uploading }"></i>
              <span v-if="!uploading">{{ uploadMode === 'url' ? 'Upload from URL' : 'Upload File' }}</span>
              <span v-else>{{ uploadMode === 'url' ? 'Downloading & Uploading...' : 'Uploading...' }}</span>
            </div>
          </button>

          <!-- CLI Usage Section -->
          <div class="bg-gray-50 rounded-xl p-4 border border-gray-200">
            <button @click="showCli = !showCli" class="w-full flex items-center justify-between text-left group">
              <div class="flex items-center gap-2">
                <i class="fas fa-terminal text-black"></i>
                <span class="font-semibold text-black">Upload via Command Line</span>
              </div>
              <i class="fas fa-chevron-down text-gray-400 transition-transform duration-300"
                :class="{ 'rotate-180': showCli }"></i>
            </button>

            <div v-if="showCli" class="mt-4 space-y-3 animate-fade-in">
              <p class="text-sm text-gray-600">Use curl to upload files from your terminal:</p>

              <div class="bg-black rounded-lg p-4">
                <div class="flex items-start justify-between gap-2 mb-2">
                  <code
                    class="text-green-400 text-xs flex-1 font-mono break-all">curl -X POST -F "file=@yourfile.pdf" {{ currentUrl }}/upload</code>
                  <button @click="copyCurlCommand"
                    class="flex-shrink-0 text-gray-400 hover:text-white transition-colors">
                    <i :class="copied ? 'fas fa-check' : 'fas fa-copy'"></i>
                  </button>
                </div>
                <p class="text-gray-400 text-xs">Replace <span class="text-yellow-400">yourfile.pdf</span> with your
                  file path</p>
              </div>
            </div>
          </div>

          <div v-if="uploading" class="text-center animate-fade-in">
            <div class="bg-white rounded-lg p-6 shadow-lg border border-gray-200">
              <div class="flex items-center justify-center gap-3 mb-4">
                <div class="animate-spin">
                  <i class="fas fa-circle-notch text-2xl text-black"></i>
                </div>
                <p class="text-black font-semibold text-lg">Uploading to IPFS...</p>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-3 mb-4">
                <div class="bg-black h-3 rounded-full transition-all duration-300 ease-out"
                  :style="{ width: uploadProgress + '%' }"></div>
              </div>
              <div class="flex justify-between items-center text-sm text-gray-600 mb-2">
                <span>{{ uploadProgress.toFixed(1) }}% complete</span>
                <span v-if="uploadProgress < 100">Uploading...</span>
                <span v-else>Processing...</span>
              </div>
              <p class="text-gray-600 text-sm">Your file is being distributed across the anonymous network</p>
            </div>
          </div>

          <div v-if="result" class="mt-6 animate-fade-in">
            <div :class="[
                  'p-6 rounded-xl shadow-lg border',
                  result.success ? 'bg-white border-gray-200' : 'bg-gray-50 border-gray-300'
                ]">
              <template v-if="result.success">
                <div class="flex items-center gap-3 mb-6 bg-green-50 border border-green-200 rounded-lg p-4">
                  <div class="flex-shrink-0">
                    <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                  </div>
                  <div>
                    <p class="font-semibold text-lg text-green-800">{{ result.message }}</p>
                    <p class="text-sm text-green-600 mt-1">Your file has been successfully uploaded to IPFS</p>
                  </div>
                </div>

                <div class="flex border-b border-gray-200 mb-4">
                  <button @click="activeTab = 'details'"
                    :class="['tab-button px-4 py-2 text-sm font-medium', activeTab === 'details' ? 'active' : 'text-gray-600 hover:text-gray-800']">
                    File Details
                  </button>
                  <button @click="activeTab = 'urls'"
                    :class="['tab-button px-4 py-2 text-sm font-medium', activeTab === 'urls' ? 'active' : 'text-gray-600 hover:text-gray-800']">
                    Access URLs
                  </button>
                  <button v-if="result.fileType" @click="activeTab = 'embed'"
                    :class="['tab-button px-4 py-2 text-sm font-medium', activeTab === 'embed' ? 'active' : 'text-gray-600 hover:text-gray-800']">
                    Embed Codes
                  </button>
                </div>

                <div class="min-h-[200px]" v-if="result.fileName">
                  <div v-if="activeTab === 'details'" class="space-y-3">
                    <div class="grid grid-cols-2 gap-3 text-sm">
                      <div class="bg-gray-50 rounded p-3">
                        <p class="text-gray-500 text-xs font-medium uppercase">File Name</p>
                        <p class="text-black font-mono text-sm truncate" :title="result.fileName">{{ result.fileName }}
                        </p>
                      </div>
                      <div class="bg-gray-50 rounded p-3">
                        <p class="text-gray-500 text-xs font-medium uppercase">File Size</p>
                        <p class="text-black font-semibold">{{ result.size }}</p>
                      </div>
                      <div class="bg-gray-50 rounded p-3">
                        <p class="text-gray-500 text-xs font-medium uppercase">MIME Type</p>
                        <p class="text-black font-mono text-sm">{{ result.mimeType }}</p>
                      </div>
                      <div class="bg-gray-50 rounded p-3">
                        <p class="text-gray-500 text-xs font-medium uppercase">Media Type</p>
                        <p class="text-black font-semibold">
                          <span v-if="result.fileType"
                            class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-200 text-black">
                            {{ result.fileType }}
                          </span>
                          <span v-else
                            class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-200 text-black">
                            file </span>
                        </p>
                      </div>
                      <div class="col-span-2 bg-gray-50 rounded p-3">
                        <p class="text-gray-500 text-xs font-medium uppercase">Content Identifier (CID)</p>
                        <p
                          class="text-black font-mono text-sm break-all bg-white rounded px-2 py-1 border border-gray-200 mt-1">
                          {{ result.cid }}</p>
                      </div>
                      <div class="col-span-2 bg-gray-50 rounded p-3" v-if="result.sha256">
                        <p class="text-gray-500 text-xs font-medium uppercase">SHA-256 Hash</p>
                        <p
                          class="text-black font-mono text-sm break-all bg-white rounded px-2 py-1 border border-gray-200 mt-1">
                          {{ result.sha256 }}</p>
                      </div>
                      <div class="bg-gray-50 rounded p-3" v-if="result.uploaded">
                        <p class="text-gray-500 text-xs font-medium uppercase">Upload Time</p>
                        <p class="text-black font-semibold">{{ new Date(result.uploaded * 1000).toLocaleString() }}</p>
                      </div>
                    </div>
                  </div>

                  <!-- Access URLs Tab -->
                  <div v-if="activeTab === 'urls'" class="space-y-3">
                    <div class="space-y-3">
                      <div>
                        <label class="text-xs text-gray-600 font-medium block mb-1">IPFS Protocol</label>
                        <input type="text" :value="getIpfsUrlWithFilename(result.cid, result.fileName)" readonly
                          class="w-full px-3 py-2 text-sm border border-gray-300 rounded bg-gray-50 font-mono text-black cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-black"
                          @click="$event.target.select()" />
                      </div>
                      <div>
                        <label class="text-xs text-gray-600 font-medium block mb-1">Gateway URL</label>
                        <input type="text" :value="getGatewayUrlForResult(result)" readonly
                          class="w-full px-3 py-2 text-sm border border-gray-300 rounded bg-gray-50 font-mono text-black cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-black"
                          @click="$event.target.select()" />
                      </div>
                      <div>
                        <label class="text-xs text-gray-600 font-medium block mb-1">Network Status</label>
                        <div class="flex gap-2">
                          <a :href="`https://check.ipfs.network/?cid=${result.cid}`" target="_blank"
                            class="inline-flex items-center gap-2 px-4 py-2 bg-black text-white rounded font-medium text-sm hover:bg-gray-800 transition-colors duration-300">
                            Check Network Propagation
                          </a>
                          <a :href="getGatewayUrlForResult(result)"
                            target="_blank"
                            class="inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded font-medium text-sm hover:bg-gray-700 transition-colors duration-300">
                            <i class="fas fa-external-link-alt"></i>
                            Open in Gateway
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div v-if="activeTab === 'embed' && result.fileType" class="space-y-4">
                    <div>
                      <label class="text-xs text-gray-600 font-medium block mb-1">HTML</label>
                      <textarea :value="getHtmlEmbed(result.cid, result.fileType, result.fileName)" readonly rows="3"
                        class="w-full px-3 py-2 text-sm border border-gray-300 rounded bg-gray-50 font-mono text-black cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-black resize-none"
                        @click="$event.target.select()"></textarea>
                    </div>
                    <div>
                      <label class="text-xs text-gray-600 font-medium block mb-1">BBCode</label>
                      <textarea :value="getBBCodeEmbed(result.cid, result.fileType, result.fileName)" readonly rows="2"
                        class="w-full px-3 py-2 text-sm border border-gray-300 rounded bg-gray-50 font-mono text-black cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-black resize-none"
                        @click="$event.target.select()"></textarea>
                    </div>
                  </div>
                </div>
              </template>

              <template v-else>
                <div class="flex items-center gap-3 bg-red-50 border border-red-200 rounded-lg p-4">
                  <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-circle text-red-600 text-2xl"></i>
                  </div>
                  <div>
                    <p class="font-semibold text-lg text-red-800">{{ result.message }}</p>
                    <p class="text-sm text-red-600 mt-1">Please try uploading your file again</p>
                  </div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </main>
    </div>

    <footer class="bg-black p-4 text-center">
      <div class="flex items-center justify-center gap-4">
        <a href="https://github.com/besoeasy/Originless" target="_blank"
          class="flex items-center gap-2 text-white hover:text-gray-300 transition-colors duration-300">
          <i class="fab fa-github"></i>
          <span class="font-semibold">GitHub</span>
        </a>
        <span class="text-gray-400">•</span>
        <span class="text-gray-300 font-mono text-sm">v{{ status.appver }}</span>
        <template v-if="nostrEnabled">
          <span class="text-gray-400">•</span>
          <a href="/dashboard.html"
            class="text-white hover:text-gray-300 transition-colors duration-300 flex items-center gap-2">
            <i class="fas fa-chart-line"></i>
            <span class="font-semibold">Dashboard</span>
          </a>
        </template>
      </div>
    </footer>
  </div>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          file: null,
          fileLabel: "Drop or Choose File",
          uploading: false,
          uploadProgress: 0,
          result: null,
          isDragOver: false,
          isPasted: false,
          activeTab: "details",
          showCli: false,
          copied: false,
          currentUrl: window.location.origin,
          nostrEnabled: false,
          uploadMode: "file", // 'file' or 'url'
          remoteUrl: "",
          status: {
            nodeId: "Loading...",
            bandwidth: "Loading...",
            repoSize: "Loading...",
            repoObjects: "Loading...",
            version: "Loading...",
            appver: "Loading...",
            timestamp: "Loading...",
            peerscount: 0,
            storageLimit: "Loading...",
            fileLimit: "Loading...",
            remoteFileLimit: "Loading...",
          },
        };
      },
      methods: {
        formatBytes(bytes) {
          const sizes = ["Bytes", "KB", "MB", "GB", "TB"];
          if (bytes === 0) return "0 Bytes";
          const i = Math.floor(Math.log(bytes) / Math.log(1024));
          return (bytes / Math.pow(1024, i)).toFixed(2) + " " + sizes[i];
        },
        updateFileLabel(event) {
          const fileInput = event.target;
          this.file = fileInput.files[0];
          this.fileLabel = this.file ? this.file.name : "Drop or Choose File";
        },
        handleDrop(event) {
          this.isDragOver = false;
          this.file = event.dataTransfer.files[0];
          this.fileLabel = this.file ? this.file.name : "Drop or Choose File";
        },
        handlePaste(event) {
          console.log("Paste event triggered", event);

          // Check if clipboard contains files
          const items = event.clipboardData?.items;
          if (!items) {
            console.log("No clipboard items found");
            return;
          }

          console.log("Clipboard items:", items.length);

          for (let i = 0; i < items.length; i++) {
            const item = items[i];
            console.log("Item", i, ":", item.kind, item.type);

            if (item.kind === "file") {
              event.preventDefault();
              const file = item.getAsFile();
              console.log("File pasted:", file);

              if (file) {
                this.file = file;
                this.fileLabel = file.name || "Pasted File";

                // Show visual feedback for paste
                this.isPasted = true;
                setTimeout(() => {
                  this.isPasted = false;
                }, 1000);

                console.log("File set successfully:", this.file.name);
                break;
              }
            }
          }
        },
        getFileTypeIcon(fileType) {
          switch (fileType) {
            case "audio":
              return "fas fa-music";
            case "video":
              return "fas fa-video";
            case "image":
              return "fas fa-image";
            default:
              return "fas fa-file";
          }
        },
        getFileType(mimeType) {
          if (mimeType.startsWith("audio/")) return "audio";
          if (mimeType.startsWith("video/")) return "video";
          if (mimeType.startsWith("image/")) return "image";
          return null;
        },
        getGatewayUrlForCid(cid, filename) {
          return this.getIpfsUrlWithFilename(cid, filename, this.gatewayBase);
        },
        getGatewayUrlForResult(result) {
          if (!result) return "";
          return result.url || this.getGatewayUrlForCid(result.cid, result.fileName);
        },
        getHtmlEmbed(cid, fileType, filename) {
          const url = this.getGatewayUrlForCid(cid, filename);
          switch (fileType) {
            case "audio":
              return `<audio controls>\n  <source src="${url}" type="audio/mpeg">\n  Your browser does not support the audio element.\n</audio>`;
            case "video":
              return `<video controls width="640" height="360">\n  <source src="${url}" type="video/mp4">\n  Your browser does not support the video element.\n</video>`;
            case "image":
              return `<img src="${url}" alt="IPFS Image" />`;
            default:
              return `<a href="${url}">Download File</a>`;
          }
        },
        getBBCodeEmbed(cid, fileType, filename) {
          const url = this.getGatewayUrlForCid(cid, filename);
          switch (fileType) {
            case "audio":
              return `[audio]${url}[/audio]`;
            case "video":
              return `[video]${url}[/video]`;
            case "image":
              return `[img]${url}[/img]`;
            default:
              return `[url=${url}]Download File[/url]`;
          }
        },
        getIpfsUrlWithFilename(cid, filename, gateway = "") {
          if (!filename) return gateway ? `${gateway}${cid}` : `ipfs://${cid}`;

          const encodedFilename = encodeURIComponent(filename);
          if (gateway) {
            return `${gateway}${cid}?filename=${encodedFilename}`;
          }
          return `ipfs://${cid}?filename=${encodedFilename}`;
        },
        async uploadFile() {
          // Validate based on upload mode
          if (this.uploadMode === 'file' && !this.file) {
            this.result = { success: false, message: "Please select a file" };
            return;
          }

          if (this.uploadMode === 'url' && !this.remoteUrl) {
            this.result = { success: false, message: "Please enter a URL" };
            return;
          }

          this.uploading = true;
          this.uploadProgress = 0;
          this.result = null;

          try {
            let response;

            if (this.uploadMode === 'file') {
              // File upload mode
              const formData = new FormData();
              formData.append("file", this.file);

              response = await axios.post("/upload", formData, {
                onUploadProgress: (progressEvent) => {
                  this.uploadProgress = (progressEvent.loaded / progressEvent.total) * 100;
                }
              });
            } else {
              // URL upload mode
              this.uploadProgress = 50; // Show progress for URL download

              response = await axios.post("/remoteupload", {
                url: this.remoteUrl
              });

              this.uploadProgress = 90;
            }

            this.uploadProgress = 100;
            this.result = {
              success: true,
              message: "Upload Successful",
              cid: response.data.cid,
              size: this.uploadMode === 'url'
                ? this.formatBytes(response.data.size)
                : this.formatBytes(response.data.size),
              fileType: this.getFileType(response.data.type),
              fileName: response.data.filename,
              mimeType: response.data.type,
              url: response.data.url,
            };

            // Clear inputs after successful upload
            if (this.uploadMode === 'url') {
              this.remoteUrl = "";
            } else {
              this.file = null;
              this.fileLabel = "Drop or Choose File";
            }
          } catch (error) {
            this.uploadProgress = 0;
            this.result = {
              success: false,
              message: error.response?.data?.message || error.message || "Upload failed",
            };
            console.error("Upload error:", error);
          } finally {
            this.uploading = false;
          }
        },
        copyCurlCommand() {
          const command = `curl -X POST -F "file=@yourfile.pdf" ${this.currentUrl}/upload`;
          navigator.clipboard
            .writeText(command)
            .then(() => {
              this.copied = true;
              setTimeout(() => {
                this.copied = false;
              }, 2000);
            })
            .catch((err) => {
              console.error("Failed to copy:", err);
            });
        },
        async fetchStatus() {
          try {
            const response = await fetch("/status");
            const data = await response.json();

            if (data.status === "success") {
              this.status = {
                nodeId: data.node.id.slice(0, 6) + "..." + data.node.id.slice(-6),
                bandwidth: `In: ${this.formatBytes(data.bandwidth.totalIn)} | Out: ${this.formatBytes(data.bandwidth.totalOut)}`,
                repoSize: `${this.formatBytes(data.repository.size)} / ${this.formatBytes(data.repository.storageMax)}`,
                repoObjects: `${data.repository.numObjects}`,
                version: `${data.node.agentVersion}`,
                appver: `${data.appVersion}`,
                timestamp: new Date(data.timestamp).toLocaleTimeString(),
                peerscount: data.peers.count,
                storageLimit: data.storageLimit?.configured || "Unknown",
                fileLimit: data.fileLimit?.formatted || data.fileLimit?.configured || "Unknown",
                remoteFileLimit: data.remoteFileLimit?.formatted || data.remoteFileLimit?.configured || "Unknown",
              };
            }
          } catch (error) {
            this.status = {
              nodeId: "Error",
              bandwidth: "Error loading",
              repoSize: "Error loading",
              repoObjects: "Error",
              version: "Error",
              appver: "Error",
              timestamp: "Error",
              peerscount: 0,
              storageLimit: "Error",
              fileLimit: "Error",
            };
          }
        },
        async checkNostrEnabled() {
          try {
            const response = await fetch("/nostr");
            const data = await response.json();
            this.nostrEnabled = data.enabled === true;
          } catch (error) {
            this.nostrEnabled = false;
          }
        },
      },
      mounted() {
        this.fetchStatus();
        this.checkNostrEnabled();
        setInterval(this.fetchStatus, 10000);

        // Add global paste event listener
        document.addEventListener("paste", this.handlePaste);

        // Focus the app to enable paste events
        this.$el.focus();
      },
      beforeUnmount() {
        // Clean up event listener
        document.removeEventListener("paste", this.handlePaste);
      },
    }).mount("#app");
  </script>
</body>

</html>